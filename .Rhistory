scale_colour_manual(name="x", labels = c("Number of patents", "Number of policies"), breaks = c("Number of patents", "Number of policies"), aesthetics = c("colour")) +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6,color="Black")) +
ggtitle("Policies vs patent counts per state - arranged by patent count - break States") +
ylab("") + xlab("")
p_c %>%
filter(state_name %in% breaks) %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_point(aes(reorder(state_name, tot_count_per_state), tot_count_per_state), color = "steelblue") +
geom_point(aes(state_name, n), color='coral2') +
coord_flip() +
scale_colour_manual(name="x", labels = c("Number of patents", "Number of policies"), aesthetics = c("colour")) +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6,color="Black")) +
ggtitle("Policies vs patent counts per state - arranged by patent count - break States") +
ylab("") + xlab("")
library(gridExtra)
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, respect = FALSE, widths = c(5), heights = c(6, 6), top = "Scatterplots")
counts <- read_csv("C:/Users/laura/OneDrive/Documenti/LAURA/HERTIE 22-23/THESIS/patent_breakdetection/model_spec/df.csv", show_col_types = FALSE) %>% group_by(state_name) %>% summarise(tot_count_per_state = sum(patent_count))
pol <- read_csv("C:/Users/laura/OneDrive/Documenti/LAURA/HERTIE 22-23/THESIS/patent_breakdetection/policy_dataset1.csv", show_col_types = FALSE) %>% select(state_name, policy_name, policy_type) %>% group_by(state_name) %>% count
p_c <- left_join(counts, pol, by = c("state_name"))
breaks <- c("Connecticut", "Delaware", "District of Columbia", "Nevada", "Oregon", "Rhode Island", "South Carolina")
p1 <- p_c %>%
filter(!state_name == "California") %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("Patent count against number of policies - California has been removed") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "none")
p2 <- p_c %>%
filter(state_name %in% breaks) %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("Patent count against number of policies - break States") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "right")
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, respect = FALSE, widths = c(5), heights = c(6, 6), top = "Scatterplots")
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, respect = FALSE, top = "Scatterplots")
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, respect = FALSE)
p1 <- p_c %>%
filter(!state_name == "California") %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("All states minus California") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "none")
p2 <- p_c %>%
filter(state_name %in% breaks) %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("break States") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "right")
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, respect = FALSE, top = "Patent count against number of policies")
p2 <- p_c %>%
filter(state_name %in% breaks) %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("break States") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "bottom")
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, respect = FALSE, top = "Patent count against number of policies")
p2 <- p_c %>%
filter(state_name %in% breaks) %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("break States") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "left")
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, respect = FALSE, top = "Patent count against number of policies")
p2 <- p_c %>%
filter(state_name %in% breaks) %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("break States") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "right")
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, widths = c(5,7), respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, widths = c(5,10), respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, widths = c(7,10), respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, widths = c(5,15), respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, widths = c(10,15), respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, widths = c(10,10), respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p2, ncol=2, nrow=1, widths = c(10,15), respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p2, ncol=1, nrow=2,respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p2, ncol=1, nrow=2, heights = c(6, 6),respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p2, ncol=1, nrow=2, widhts = c(5), heights = c(6, 6),respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p2, ncol=1, nrow=2, widths = c(5), heights = c(6, 6),respect = FALSE, top = "Patent count against number of policies")
p1 <- p_c %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("All states minus California") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "none")
p2 <- p_c %>%
filter(state_name %in% breaks) %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("break States") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "right")
scat <- grid.arrange(p1, p2, ncol=1, nrow=2, widths = c(5), heights = c(6, 6),respect = FALSE, top = "Patent count against number of policies")
counts <- read_csv("C:/Users/laura/OneDrive/Documenti/LAURA/HERTIE 22-23/THESIS/patent_breakdetection/model_spec/df.csv", show_col_types = FALSE) %>% group_by(state_name) %>% summarise(tot_count_per_state = sum(patent_count))
pol <- read_csv("C:/Users/laura/OneDrive/Documenti/LAURA/HERTIE 22-23/THESIS/patent_breakdetection/policy_dataset1.csv", show_col_types = FALSE) %>% select(state_name, policy_name, policy_type) %>% group_by(state_name) %>% count
p_c <- left_join(counts, pol, by = c("state_name"))
breaks <- c("Connecticut", "Delaware", "District of Columbia", "Nevada", "Oregon", "Rhode Island", "South Carolina")
p1 <- p_c %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("All states") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "none")
p2 <- p_c %>%
filter(state_name %in% breaks) %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("break States") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "right")
scat <- grid.arrange(p1, p2, ncol=1, nrow=2, widths = c(5), heights = c(6, 6),respect = FALSE, top = "Patent count against number of policies")
counts <- read_csv("C:/Users/laura/OneDrive/Documenti/LAURA/HERTIE 22-23/THESIS/patent_breakdetection/model_spec/df.csv", show_col_types = FALSE) %>% group_by(state_name) %>% summarise(tot_count_per_state = sum(patent_count))
pol <- read_csv("C:/Users/laura/OneDrive/Documenti/LAURA/HERTIE 22-23/THESIS/patent_breakdetection/policy_dataset1.csv", show_col_types = FALSE) %>% select(state_name, policy_name, policy_type) %>% group_by(state_name) %>% count
p_c <- left_join(counts, pol, by = c("state_name"))
breaks <- c("Connecticut", "Delaware", "District of Columbia", "Nevada", "Oregon", "Rhode Island", "South Carolina")
p1 <- p_c %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("All states") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "none")
p3 <- p_c %>%
filter(!state_name == "California") %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("All states - no California") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "none")
p2 <- p_c %>%
filter(state_name %in% breaks) %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("break States") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "right")
scat <- grid.arrange(p1, p3, p2, ncol=1, nrow=3, widths = c(5), heights = c(6, 6),respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p3, p2, ncol=1, nrow=3, widths = c(5), heights = c(6, 6, 6),respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p3, p2, ncol=1, nrow=3, widths = c(7), heights = c(6, 6, 6),respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p3, p2, ncol=1, nrow=3, widths = c(10), heights = c(6, 6, 6),respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p3, p2, ncol=3, nrow=1, widths = c(10), heights = c(6, 6, 6),respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p3, p2, ncol=3, nrow=1, widths = c(6, 6, 6), heights = c(10),respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p3, p2, ncol=3, nrow=1, widths = c(6, 6, 16), heights = c(10),respect = FALSE, top = "Patent count against number of policies")
scat <- grid.arrange(p1, p3, p2, ncol=3, nrow=1, widths = c(6, 6, 13), heights = c(10),respect = FALSE, top = "Patent count against number of policies")
counts <- read_csv("C:/Users/laura/OneDrive/Documenti/LAURA/HERTIE 22-23/THESIS/patent_breakdetection/model_spec/df.csv", show_col_types = FALSE) %>% group_by(state_name) %>% summarise(tot_count_per_state = sum(patent_count))
pol <- read_csv("C:/Users/laura/OneDrive/Documenti/LAURA/HERTIE 22-23/THESIS/patent_breakdetection/policy_dataset1.csv", show_col_types = FALSE) %>% select(state_name, policy_name, policy_type) %>% group_by(state_name) %>% count
p_c <- left_join(counts, pol, by = c("state_name"))
breaks <- c("Connecticut", "Delaware", "District of Columbia", "Nevada", "Oregon", "Rhode Island", "South Carolina")
p1 <- p_c %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("All states") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "none")
p3 <- p_c %>%
filter(!state_name == "California") %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("All states - no California") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "none")
p2 <- p_c %>%
filter(state_name %in% breaks) %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("break States") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "right")
scat <- grid.arrange(p1, p3, p2, ncol=1, nrow=3, widths = c(10), heights = c(6, 6, 6),respect = FALSE, top = "Patent count against number of policies")
leg <- c("Patent count", "Number of policies")
s1 <- p_c %>%
filter(!state_name == "California") %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_point(aes(reorder(state_name, tot_count_per_state), tot_count_per_state), color = "steelblue") +
geom_point(aes(state_name, n), color='coral2') +
coord_flip() +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6,color="Black")) +
ggtitle("All states - no California") +
ylab("") + xlab("")
s2 <- p_c %>%
filter(state_name %in% breaks) %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_point(aes(reorder(state_name, tot_count_per_state), tot_count_per_state), color = "steelblue") +
geom_point(aes(state_name, n), color='coral2') +
coord_flip() +
scale_colour_manual(name="x", labels = c("Number of patents", "Number of policies"), aesthetics = c("colour")) +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6,color="Black")) +
ggtitle("break States") +
ylab("") + xlab("")
scat2 <- grid.arrange(s1, s2, ncol=1, nrow=2, widths = c(5), heights = c(6, 6),respect = FALSE, top = "Policies vs patent counts per state - arranged by patent count")
scat2 <- grid.arrange(s1, s2, ncol=1, nrow=2, widths = c(5), heights = c(7, 6),respect = FALSE, top = "Policies vs patent counts per state - arranged by patent count")
s1 <- p_c %>%
filter(!state_name == "California") %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_point(aes(reorder(state_name, tot_count_per_state), tot_count_per_state), color = "steelblue") +
geom_point(aes(state_name, n), color='coral2') +
coord_flip() +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6,color="Black")) +
ggtitle("All states except California") +
ylab("") + xlab("")
s2 <- p_c %>%
filter(state_name %in% breaks) %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_point(aes(reorder(state_name, tot_count_per_state), tot_count_per_state), color = "steelblue") +
geom_point(aes(state_name, n), color='coral2') +
coord_flip() +
scale_colour_manual(name="x", labels = c("Number of patents", "Number of policies"), aesthetics = c("colour")) +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6,color="Black")) +
ggtitle("break States") +
ylab("") + xlab("")
scat2 <- grid.arrange(s1, s2, ncol=1, nrow=2, widths = c(5), heights = c(7, 6),respect = FALSE, top = "Policies vs patent counts per state - arranged by patent count")
scat2 <- grid.arrange(s1, s2, ncol=1, nrow=2, widths = c(5), heights = c(8, 6),respect = FALSE, top = "Policies vs patent counts per state - arranged by patent count")
knitr::opts_chunk$set(echo = TRUE, max.height = '300px', fig.width = 16, fig.height = 8) #fig.show="hold",,
library(data.table)
library(tidyverse)
library(openxlsx)
library(gets)
library(getspanel)
library(here)
library(doParallel)
library(gridExtra)
library(conflicted)
library(viridis)
library(kableExtra)
#library(gplots)
library(parameters)
library(pander)
conflict_prefer("filter", "dplyr")
conflict_prefer("first", "dplyr")
conflict_prefer("lag", "dplyr")
counts <- read_csv("C:/Users/laura/OneDrive/Documenti/LAURA/HERTIE 22-23/THESIS/patent_breakdetection/model_spec/df.csv", show_col_types = FALSE) %>% group_by(state_name) %>% summarise(tot_count_per_state = sum(patent_count))
pol <- read_csv("C:/Users/laura/OneDrive/Documenti/LAURA/HERTIE 22-23/THESIS/patent_breakdetection/policy_dataset1.csv", show_col_types = FALSE) %>% select(state_name, policy_name, policy_type) %>% group_by(state_name) %>% count
p_c <- left_join(counts, pol, by = c("state_name"))
breaks <- c("Connecticut", "Delaware", "District of Columbia", "Nevada", "Oregon", "Rhode Island", "South Carolina")
p1 <- p_c %>%
ggplot(aes(x = tot_count_per_state, y = n))+
geom_point(size=2) +
theme_bw()+
ggtitle("All states") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "none")
p3 <- p_c %>%
filter(!state_name == "California") %>%
ggplot(aes(x = tot_count_per_state, y = n))+
geom_point(size=2) +
theme_bw()+
ggtitle("All states - no California") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "none")
p2 <- p_c %>%
filter(state_name %in% breaks) %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("break States") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "right")
scat <- grid.arrange(p1, p3, p2, ncol=1, nrow=3, widths = c(10), heights = c(6, 6, 6),respect = FALSE, top = "Patent count against number of policies")
counts <- read_csv("C:/Users/laura/OneDrive/Documenti/LAURA/HERTIE 22-23/THESIS/patent_breakdetection/model_spec/df.csv", show_col_types = FALSE) %>% group_by(state_name) %>% summarise(tot_count_per_state = sum(patent_count))
pol <- read_csv("C:/Users/laura/OneDrive/Documenti/LAURA/HERTIE 22-23/THESIS/patent_breakdetection/policy_dataset1.csv", show_col_types = FALSE) %>% select(state_name, policy_name, policy_type) %>% group_by(state_name) %>% count
p_c <- left_join(counts, pol, by = c("state_name"))
breaks <- c("Connecticut", "Delaware", "District of Columbia", "Nevada", "Oregon", "Rhode Island", "South Carolina")
p1 <- p_c %>%
ggplot(aes(x = tot_count_per_state, y = n, color = "coral3"))+
geom_point(size=2, alpha = 0.7)+
theme_bw()+
ggtitle("All states") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "none")
p3 <- p_c %>%
filter(!state_name == "California") %>%
ggplot(aes(x = tot_count_per_state, y = n, color = "coral3"))+
geom_point(size=2, alpha = 0.7) +
theme_bw()+
ggtitle("All states - no California") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "none")
p2 <- p_c %>%
filter(state_name %in% breaks) %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=2) +
theme_bw()+
ggtitle("break States") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "right")
scat <- grid.arrange(p1, p3, p2, ncol=1, nrow=3, widths = c(10), heights = c(6, 6, 6),respect = FALSE, top = "Patent count against number of policies")
counts <- read_csv("C:/Users/laura/OneDrive/Documenti/LAURA/HERTIE 22-23/THESIS/patent_breakdetection/model_spec/df.csv", show_col_types = FALSE) %>% group_by(state_name) %>% summarise(tot_count_per_state = sum(patent_count))
pol <- read_csv("C:/Users/laura/OneDrive/Documenti/LAURA/HERTIE 22-23/THESIS/patent_breakdetection/policy_dataset1.csv", show_col_types = FALSE) %>% select(state_name, policy_name, policy_type) %>% group_by(state_name) %>% count
p_c <- left_join(counts, pol, by = c("state_name"))
breaks <- c("Connecticut", "Delaware", "District of Columbia", "Nevada", "Oregon", "Rhode Island", "South Carolina")
p1 <- p_c %>%
ggplot(aes(x = tot_count_per_state, y = n, color = "coral3"))+
geom_point(size=1, alpha = 0.7)+
theme_bw()+
ggtitle("All states") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "none")
p3 <- p_c %>%
filter(!state_name == "California") %>%
ggplot(aes(x = tot_count_per_state, y = n, color = "coral3"))+
geom_point(size=1, alpha = 0.7) +
theme_bw()+
ggtitle("All states - no California") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "none")
p2 <- p_c %>%
filter(state_name %in% breaks) %>%
ggplot(aes(x = tot_count_per_state, y = n, color = state_name))+
geom_point(size=1) +
theme_bw()+
ggtitle("break States") +
ylab("number of policies") + xlab("patent counts") +
theme(legend.position = "right")
scat <- grid.arrange(p1, p3, p2, ncol=1, nrow=3, widths = c(10), heights = c(6, 6, 6),respect = FALSE, top = "Patent count against number of policies")
# leg <- c("Patent count", "Number of policies")
s1 <- p_c %>%
filter(!state_name == "California") %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_col(aes(reorder(state_name, tot_count_per_state), tot_count_per_state), color = "steelblue") +
geom_col(aes(state_name, n), color='coral2') +
coord_flip() +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6,color="Black")) +
ggtitle("All states except California") +
ylab("") + xlab("")
s2 <- p_c %>%
filter(state_name %in% breaks) %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_col(aes(reorder(state_name, tot_count_per_state), tot_count_per_state), color = "steelblue") +
geom_col(aes(state_name, n), color='coral2') +
coord_flip() +
scale_colour_manual(name="x", labels = c("Number of patents", "Number of policies"), aesthetics = c("colour")) +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6,color="Black")) +
ggtitle("break States") +
ylab("") + xlab("")
scat2 <- grid.arrange(s1, s2, ncol=1, nrow=2, widths = c(5), heights = c(8, 6),respect = FALSE, top = "Policies vs patent counts per state - arranged by patent count")
# leg <- c("Patent count", "Number of policies")
s1 <- p_c %>%
filter(!state_name == "California") %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_col(aes(reorder(state_name, tot_count_per_state), tot_count_per_state),  fill  = "steelblue") +
geom_col(aes(state_name, n),  fill ='coral2') +
coord_flip() +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6, color ="Black")) +
ggtitle("All states except California") +
ylab("") + xlab("")
s2 <- p_c %>%
filter(state_name %in% breaks) %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_col(aes(reorder(state_name, tot_count_per_state), tot_count_per_state),  fill  = "steelblue") +
geom_col(aes(state_name, n),  fill ='coral2') +
coord_flip() +
scale_colour_manual(name="x", labels = c("Number of patents", "Number of policies"), aesthetics = c("colour")) +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6,color="Black")) +
ggtitle("break States") +
ylab("") + xlab("")
scat2 <- grid.arrange(s1, s2, ncol=1, nrow=2, widths = c(5), heights = c(8, 6),respect = FALSE, top = "Policies vs patent counts per state - arranged by patent count")
# leg <- c("Patent count", "Number of policies")
s1 <- p_c %>%
filter(!state_name == "California") %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_col(aes(reorder(state_name, tot_count_per_state), tot_count_per_state),  fill  = "steelblue") +
geom_col(aes(reorder(state_name, n), n,  fill ='coral2') +
coord_flip() +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6, color ="Black")) +
ggtitle("All states except California") +
ylab("") + xlab("")
s2 <- p_c %>%
# leg <- c("Patent count", "Number of policies")
s1 <- p_c %>%
filter(!state_name == "California") %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_col(aes(reorder(state_name, tot_count_per_state), tot_count_per_state),  fill  = "steelblue") +
geom_col(aes(reorder(state_name, n), n,  fill ='coral2')) +
coord_flip() +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6, color ="Black")) +
ggtitle("All states except California") +
ylab("") + xlab("")
s2 <- p_c %>%
filter(state_name %in% breaks) %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_col(aes(reorder(state_name, tot_count_per_state), tot_count_per_state),  fill  = "steelblue") +
geom_col(aes(state_name, n),  fill ='coral2') +
coord_flip() +
scale_colour_manual(name="x", labels = c("Number of patents", "Number of policies"), aesthetics = c("colour")) +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6,color="Black")) +
ggtitle("break States") +
ylab("") + xlab("")
scat2 <- grid.arrange(s1, s2, ncol=1, nrow=2, widths = c(5), heights = c(8, 6),respect = FALSE, top = "Policies vs patent counts per state - arranged by patent count")
# leg <- c("Patent count", "Number of policies")
s1 <- p_c %>%
filter(!state_name == "California") %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_col(aes(reorder(state_name, tot_count_per_state), tot_count_per_state),  fill  = "steelblue") +
geom_col(aes(reorder(state_name, n), n),  fill ='coral2') +
coord_flip() +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6, color ="Black")) +
ggtitle("All states except California") +
ylab("") + xlab("")
s2 <- p_c %>%
filter(state_name %in% breaks) %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_col(aes(reorder(state_name, tot_count_per_state), tot_count_per_state),  fill  = "steelblue") +
geom_col(aes(state_name, n),  fill ='coral2') +
coord_flip() +
scale_colour_manual(name="x", labels = c("Number of patents", "Number of policies"), aesthetics = c("colour")) +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6,color="Black")) +
ggtitle("break States") +
ylab("") + xlab("")
scat2 <- grid.arrange(s1, s2, ncol=1, nrow=2, widths = c(5), heights = c(8, 6),respect = FALSE, top = "Policies vs patent counts per state - arranged by patent count")
# leg <- c("Patent count", "Number of policies")
s1 <- p_c %>%
filter(!state_name == "California") %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_col(aes(reorder(state_name, tot_count_per_state), tot_count_per_state),  fill  = "steelblue") +
geom_col(aes(reorder(state_name, n), n),  fill ='coral3') +
coord_flip() +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6, color ="Black")) +
ggtitle("All states except California") +
ylab("") + xlab("")
s2 <- p_c %>%
filter(state_name %in% breaks) %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_col(aes(reorder(state_name, tot_count_per_state), tot_count_per_state),  fill  = "steelblue") +
geom_col(aes(state_name, n),  fill ='coral2') +
coord_flip() +
scale_colour_manual(name="x", labels = c("Number of patents", "Number of policies"), aesthetics = c("colour")) +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6,color="Black")) +
ggtitle("break States") +
ylab("") + xlab("")
scat2 <- grid.arrange(s1, s2, ncol=1, nrow=2, widths = c(5), heights = c(8, 6),respect = FALSE, top = "Policies vs patent counts per state - arranged by patent count")
# leg <- c("Patent count", "Number of policies")
s1 <- p_c %>%
filter(!state_name == "California") %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_col(aes(reorder(state_name, tot_count_per_state), tot_count_per_state),  fill  = "steelblue") +
geom_col(aes(reorder(state_name, n), n),  fill ='coral2') +
coord_flip() +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6, color ="Black")) +
ggtitle("All states except California") +
ylab("") + xlab("")
s2 <- p_c %>%
filter(state_name %in% breaks) %>%
arrange(desc(tot_count_per_state)) %>%
ggplot() +
geom_col(aes(reorder(state_name, tot_count_per_state), tot_count_per_state),  fill  = "steelblue") +
geom_col(aes(state_name, n),  fill ='coral2') +
coord_flip() +
scale_colour_manual(name="x", labels = c("Number of patents", "Number of policies"), aesthetics = c("colour")) +
theme_bw() +
theme(axis.text.y = element_text( hjust = 1, size=6,color="Black")) +
ggtitle("break States") +
ylab("") + xlab("")
scat2 <- grid.arrange(s1, s2, ncol=1, nrow=2, widths = c(5), heights = c(8, 6),respect = FALSE, top = "Policies vs patent counts per state - arranged by patent count")
