#for (i in 1:nrow(levels_y_trans)){
#  print(levels_y_trans$is[[i]])
#}
models$is[[28]] # high income countries, ar = 1, logs, pval = 0.001, ihs y
models$is[[26]] # high income countries, ar = 0, logs, pval = 0.001, ihs y
models$is[[32]] # low income countries, ar = 1, logs, pval = 0.001, ihs y
models$is[[30]] # low income countries, ar = 0, logs, pval = 0.001, ihs y
plot(models$is[[2]])
plot(models$is[[6]])
plot(models$is[[2]]) # levels
plot(models$is[[4]]) # levels
plot(models$is[[8]])
plot(models$is[[29]]) # high income countries, ar = 1, logs, pval = 0.001, ihs y
#plot(models$is[[26]]) # high income countries, ar = 0, logs, pval = 0.001, ihs y
plot(models$is[[31]]) # low income countries, ar = 1, logs, pval = 0.001, ihs y
#(models$is[[30]]) # low income countries, ar = 0, logs, pval = 0.001, ihs y
plot(models$is[[27]]) # high income countries, ar = 1, logs, pval = 0.001, ihs y
plot(models$is[[27]]) # high income countries, ar = 1, logs, pval = 0.001, ihs y
#plot(models$is[[26]]) # high income countries, ar = 0, logs, pval = 0.001, ihs y
plot(models$is[[31]]) # low income countries, ar = 1, logs, pval = 0.001, ihs y
#(models$is[[30]]) # low income countries, ar = 0, logs, pval = 0.001, ihs y
library(tidyverse)
df <- (".\\df.csv")
library(tidyverse)
df <- (".\\df.csv")
df <- read_csv(".\\df.csv")
df <- read_csv(".\\model_spec\\df.csv")
library(tidyverse)
df <- read_csv(".\\model_spec\\df.csv")
# Basic box plot
df$prio_year.factor <- factor(df$prio_year)
box_plot_by_year <- ggplot(df) +
geom_boxplot(mapping = aes(x = prio_year.factor,
y = patent_count),
outlier.colour="red",
outlier.size=1) +
labs(x = "Priority filing year", y =  "Patent count") + theme_bw() + ggtitle("International US patent counts (Y02E class)", subtitle = "Summary statistics over the time series")
box_plot_by_year
ggsave(".\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
ggsave(".\\figs_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
ggsave(".\\fig_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
# Basic box plot
df$prio_year.factor <- factor(df$prio_year)
box_plot_by_year <- ggplot(df) +
geom_boxplot(mapping = aes(x = prio_year.factor,
y = patent_count),
outlier.colour="red",
outlier.size=1) +
labs(x = "Priority filing year", y =  "Patent count") + theme_bw() + ggtitle("International US patent counts (Y02E class)", subtitle = "Summary statistics over the time series")
box_plot_by_year
# ggsave(".\\fig_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
# Basic box plot
df$prio_year.factor <- factor(df$prio_year)
box_plot_by_year <- ggplot(df) +
geom_boxplot(mapping = aes(x = prio_year.factor,
y = patent_count),
outlier.colour="red",
outlier.size=1) +
labs(x = "Priority filing year", y =  "Patent count") + theme_bw() + ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution over time")
box_plot_by_year
ggsave(".\\fig_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
df$prio_year.factor <- factor(df$prio_year)
box_plot_by_state <- ggplot(df) +
geom_boxplot(mapping = aes(x = prio_year.factor,
y = patent_count),
outlier.colour="red",
outlier.size=1) +
labs(x = "Priority filing year", y =  "Patent count") + facet_wrap(~state_name) + theme_bw() + ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by State")
box_plot_by_state
# ggsave(".\\figs_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
# Basic box plot
df$prio_year.factor <- factor(df$prio_year)
box_plot_by_year <- ggplot(df) +
geom_boxplot(mapping = aes(x = prio_year.factor,
y = patent_count),
outlier.colour="red",
outlier.size=1) +
labs(x = "Priority filing year", y =  "Patent count") + theme_bw() + ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution over time")
box_plot_by_year
ggsave(".\\fig_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
df$prio_year.factor <- factor(df$prio_year)
box_plot_by_state <- ggplot(df) +
geom_boxplot(mapping = aes(x = prio_year.factor,
y = patent_count),
outlier.colour="red",
outlier.size=1) +
labs(x = "Priority filing year", y =  "Patent count") + facet_wrap(~state_name) + theme_bw() + ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by State")
box_plot_by_state
# ggsave(".\\figs_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
df$prio_year.factor <- factor(df$prio_year)
box_plot_by_state <- ggplot(df) +
geom_boxplot(mapping = aes(x = prio_year.factor,
y = patent_count),
outlier.colour="red",
outlier.size=1) +
+ geom_jitter(width = 0.2)+
labs(x = "Priority filing year", y =  "Patent count") +        facet_wrap(~state_name) +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by State")
df$prio_year.factor <- factor(df$prio_year)
box_plot_by_state <- ggplot(df) +
geom_boxplot(mapping = aes(x = prio_year.factor,
y = patent_count),
outlier.colour="red",
outlier.size=1) +
geom_jitter(width = 0.2) +
labs(x = "Priority filing year", y =  "Patent count") +
facet_wrap(~state_name) +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by State")
box_plot_by_state
df$prio_year.factor <- factor(df$prio_year)
box_plot_by_state <- ggplot(df) +
geom_boxplot(mapping = aes(x = prio_year.factor,
y = patent_count),
outlier.colour="red",
outlier.size=1) +
geom_jitter(mapping = aes(x = prio_year.factor,
y = patent_count),
width = 0.2) +
labs(x = "Priority filing year", y =  "Patent count") +
facet_wrap(~state_name) +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by State")
box_plot_by_state
# ggsave(".\\figs_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
View(df)
df$prio_year.factor <- factor(df$prio_year)
box_plot_by_state <- df %>%
group_by(state_name) %>%
ggplot(aes(x = prio_year.factor, y = patent_count)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
labs(x = "Priority filing year", y =  "Patent count") +
facet_wrap(~state_name) +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by State")
box_plot_by_state
# ggsave(".\\figs_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
df$prio_year.factor <- factor(df$prio_year)
box_plot_by_state <- df %>%
group_by(state_name) %>%
ggplot(aes(x = patent_count)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
labs(x = "Priority filing year", y =  "Patent count") +
facet_wrap(~state_name) +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by State")
box_plot_by_state
# ggsave(".\\figs_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
df$prio_year.factor <- factor(df$prio_year)
box_plot_by_state <- df %>%
group_by(state_name) %>%
ggplot(aes(y = patent_count, x = prio_year)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
labs(x = "Priority filing year", y =  "Patent count") +
facet_wrap(~state_name) +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by State")
box_plot_by_state
# ggsave(".\\figs_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
box_plot_by_state <- df %>%
group_by(state_name) %>%
ggplot(aes(y = patent_count, x = factor(prio_year))) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by State")
box_plot_by_state
# ggsave(".\\figs_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
box_plot_by_state <- df %>%
group_by(state_name) %>%
ggplot(aes(y = patent_count, x = prio_year)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by State")
box_plot_by_state
# ggsave(".\\figs_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
box_plot_by_state <- df %>%
group_by(state_name) %>%
ggplot(aes(y = patent_count, x = prio_year)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
scale_x_continuous(breaks = c(2000, 2005, 2010, 2015, 2020))
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by State")
box_plot_by_state <- df %>%
group_by(state_name) %>%
ggplot(aes(y = patent_count, x = prio_year)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
scale_x_continuous(breaks = c(2000, 2005, 2010, 2015, 2020)) +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by State")
box_plot_by_state
# ggsave(".\\figs_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
box_plot_by_state <- df %>%
group_by(state_name) %>%
ggplot(aes(y = patent_count, x = prio_year)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
scale_x_continuous(limits = c(2000, 2005, 2010, 2015, 2020)) +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by State")
box_plot_by_state
# ggsave(".\\figs_new\\box_plot_by_year.png", plot = box_plot_by_year, device = "png", width = 10, height = 10)
pat_all <- read_csv("D:/patent_counts_direct_epo_pct.csv")
pat_all <- read_csv("D:/PCT_EPO_counts/patent_counts_direct_epo_pct.csv")
pat_all_series <- pat_all %>%
filter(region != "United States - not regionalised") %>%
group_by(region) %>%
ggplot(aes(x = prio_year, y = patent_count)) +
geom_line(linewidth = 0.3) +
facet_wrap(~region) +
theme_minimal() +
ggtitle("Total patent counts by US State (Y02E class)", subtitle = "PCT and direct EPO aggregation")
pat_all_series
ggsave("ALL_count_timeseries.png", plot = pat_all_series, device = "png", width = 10, height = 10)
pat_all <- read_csv("D:/PCT_EPO_counts/patent_counts_direct_epo_pct.csv", show_col_types = FALSE)
pat_all_series <- pat_all %>%
filter(region != "United States - not regionalised") %>%
group_by(region) %>%
ggplot(aes(x = prio_year, y = patent_count)) +
geom_line(linewidth = 0.3, fill = "navy") +
facet_wrap(~region) +
theme_minimal() +
labs(x = "Priority year", y = "Patent counts") +
ggtitle("Total patent counts by US State (Y02E class)", subtitle = "PCT and direct EPO aggregation")
pat_all_series
ggsave("ALL_count_timeseries.png", plot = pat_all_series, device = "png", width = 10, height = 10)
pat_all <- read_csv("D:/PCT_EPO_counts/patent_counts_direct_epo_pct.csv", show_col_types = FALSE)
pat_all_series <- pat_all %>%
filter(region != "United States - not regionalised") %>%
group_by(region) %>%
ggplot(aes(x = prio_year, y = patent_count)) +
geom_line(linewidth = 0.5, fill = "navy") +
facet_wrap(~region) +
theme_minimal() +
labs(x = "Priority year", y = "Patent counts") +
ggtitle("Total patent counts by US State (Y02E class)", subtitle = "PCT and direct EPO aggregation")
pat_all_series
ggsave("ALL_count_timeseries.png", plot = pat_all_series, device = "png", width = 10, height = 10)
pat_all <- read_csv("D:/PCT_EPO_counts/patent_counts_direct_epo_pct.csv", show_col_types = FALSE)
pat_all_series <- pat_all %>%
filter(region != "United States - not regionalised") %>%
group_by(region) %>%
ggplot(aes(x = prio_year, y = patent_count)) +
geom_line(linewidth = 0.5, colour = "navy") +
facet_wrap(~region) +
theme_minimal() +
labs(x = "Priority year", y = "Patent counts") +
ggtitle("Total patent counts by US State (Y02E class)", subtitle = "PCT and direct EPO aggregation")
pat_all_series
ggsave("ALL_count_timeseries.png", plot = pat_all_series, device = "png", width = 10, height = 10)
pat_all <- read_csv("D:/PCT_EPO_counts/patent_counts_direct_epo_pct.csv", show_col_types = FALSE)
pat_all_series <- pat_all %>%
filter(region != "United States - not regionalised") %>%
group_by(region) %>%
ggplot(aes(x = prio_year, y = patent_count)) +
geom_line(linewidth = 0.5, colour = "navy") +
facet_wrap(~region) +
theme_minimal() +
labs(x = "Priority year", y = "Patent count") +
ggtitle("Total patent counts by US State (Y02E class)", subtitle = "PCT and direct EPO aggregation")
pat_all_series
ggsave("ALL_count_timeseries.png", plot = pat_all_series, device = "png", width = 10, height = 10)
df %>%
geom_histogram(x = patent_count, fill = "navy", colour = "black")
View(df)
df %>%
ggplot(aes(x = patent_count)) %>%
geom_histogram(fill = "navy", colour = "black")
df %>%
ggplot(aes(x = patent_count)) +
geom_histogram(fill = "navy", colour = "black")
df %>%
ggplot(aes(x = patent_count)) +
geom_histogram(fill = "navy", colour = "black") +
labs(x = "Dependent variable (y) = patent counts", y = "")
df %>%
ggplot(aes(x = patent_count)) +
geom_histogram(fill = "navy", colour = "black") +
labs(x = "Dependent variable (y) = patent counts", y = "") +
ggtitle("Distribution of the dependent variable")+
theme_bw()
df %>%
ggplot(aes(x = patent_count)) + geom_histogram(fill= "lightblue", colour = "black") + theme_bw()
y_dist <- df %>%
ggplot(aes(x = patent_count)) +
geom_histogram(fill = "pink", colour = "black") +
labs(x = "Dependent variable (y) = patent counts", y = "") +
ggtitle("Distribution of the dependent variable")+
theme_bw()
y_dist
ggsave(".\\fig_new\\y_distribution.png", plot = y_dist, device = "png", width = 10, height = 10)
y_dist <- df %>%
ggplot(aes(x = patent_count)) +
geom_histogram(fill = "navy", colour = "black") +
labs(x = "Dependent variable (y) = patent counts", y = "") +
ggtitle("Distribution of the dependent variable")+
theme_bw()
y_dist
ggsave(".\\fig_new\\y_distribution.png", plot = y_dist, device = "png", width = 10, height = 10)
y_dist <- df %>%
ggplot(aes(x = patent_count)) +
geom_histogram(fill = "navy", colour = "black") +
labs(x = "Dependent variable (y) = patent counts", y = "") +
ggtitle("Distribution of the dependent variable")+
theme_bw()
y_dist
ggsave(".\\fig_new\\y_distribution.png", plot = y_dist, device = "png", width = 8, height = 8)
plot(models$is[[4]]) # levels, ar = 1
plot(models$is[[8]]) # levels
plot(models$is[[3]]) # patent_count ~ gdp + pop + avg_temp + fuel, high incomw, pval = 0.010, ar=1
plot(models$is[[7]]) # patent_count ~ gdp + pop + avg_temp + fuel, high incomw, pval = 0.010, ar=1
models <- readRDS(".\\levels_y_transformations.RDS")
m <- models %>% filter(source == "patent_count ~ gdp + pop + avg_temp + fuel" & year_range == "2000:2020" & ar == 0 & p_val == "0.01") %>% gen_p(.)
library(tidyverse)
library(gets)
library(getspanel)
library(here)
library(doParallel)
library(readxl)
library(grid)
library(gridExtra)
# Plotting functions
f <- function(k) {
step <- k
function(y) seq(floor(min(y)), ceiling(max(y)), by = step)
}
# Arranges result plots (plot and plot_grid) and prints model results
# Option to suppress model results using results = FALSE is required for automatic tabsetting.
gen_p <- function(df, results = TRUE){
if(nrow(df) == 0){return("Empty data frame. Model likely not run.")}else{
for(i in 1:nrow(df)){
mt <- paste0(df$country_sample[i], " (", df$year_range[i],")", "; p.value: ",df$p_val[i],  "; AR: ",df$ar[i])
st <- paste0("Formula: ", df$form[i])
res <- df %>% slice(i) %>% pull(is) %>% first
pl <- res %>%
plot(zero_line = FALSE) +
ggtitle(label = mt, subtitle = st) +
scale_x_continuous(breaks = f(10))
pg <- res %>%
plot_grid() +
ggtitle(label = mt, subtitle = st)
grid.arrange(pl, pg, ncol = 2)
if(results == TRUE){
print(st)
print(mt)
print(res)
}
}
}
}
models <- readRDS(".\\levels_y_transformations.RDS")
m <- models %>% filter(source == "patent_count ~ gdp + pop + avg_temp + fuel" & year_range == "2000:2020" & ar == 0 & p_val == "0.01") %>% gen_p(.)
class(m)
m <- models %>% filter(source == "patent_count ~ gdp + pop + avg_temp + fuel" & year_range == "2000:2020" & ar == 0 & p_val == "0.01") %>% gen_p(.)
models <- readRDS(".\\results\\logs_ytrans_samples.RDS")
plot(models$is[[27]]) # high income countries, ar = 1, logs, pval = 0.001, ihs y
plot(models$is[[31]]) # low income countries, ar = 1, logs, pval = 0.001, ihs y
models
models
models <- readRDS(".\\results\\logs_ytrans_samples.RDS")
y_transf_logs_sample_high <- plot(models$is[[27]]) # high income countries, ar = 1, logs, pval = 0.001, ihs y
ggsave("y_transf_logs_sample_high.png", plot = y_transf_logs_sample_high, device = "png", width = 10, height = 10)
#plot(models$is[[26]]) # high income countries, ar = 0, logs, pval = 0.001, ihs y
y_transf_logs_sample_low <- plot(models$is[[31]]) # low income countries, ar = 1, logs, pval = 0.001, ihs y
ggsave("y_transf_logs_sample_low.png", plot = y_transf_logs_sample_low, device = "png", width = 10, height = 10)
#(models$is[[30]]) # low income countries, ar = 0, logs, pval = 0.001, ihs y
library(tidyverse)
library(gets)
library(getspanel)
library(here)
library(doParallel)
library(readxl)
### for auto-tabs
library(grid)
library(gridExtra)
box_plot_by_gdp <- df %>%
group_by(state_name) %>%
filter(state_name %in% gdp_low) %>%
ggplot(aes(y = patent_count, x = prio_year)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
scale_x_continuous(limits = c(2000, 2005, 2010, 2015, 2020)) +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by low income state")
box_plot_by_gdp
box_plot_by_high_gdp <- df %>%
group_by(state_name) %>%
filter(state_name %in% gdp_high) %>%
ggplot(aes(y = patent_count, x = prio_year)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
scale_x_continuous(limits = c(2000, 2005, 2010, 2015, 2020)) +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by low income state")
box_plot_by_high_gdp
box_plot_by_high_gdp <- df %>%
group_by(state_name) %>%
filter(state_name %in% gdp_high) %>%
ggplot(aes(y = patent_count, x = prio_year)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
scale_x_continuous(limits = c(2000, 2005, 2010, 2015, 2020)) +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by high income state")
box_plot_by_high_gdp
box_plot_by_low_gdp <- df %>%
filter(state_name %in% gdp_low) %>%
ggplot(aes(y = patent_count, x = prio_year)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
scale_x_continuous(limits = c(2000, 2005, 2010, 2015, 2020)) +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by low income state")
box_plot_by_low_gdp
box_plot_by_high_gdp <- df %>%
filter(state_name %in% gdp_high) %>%
ggplot(aes(y = patent_count, x = prio_year)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
scale_x_continuous(limits = c(2000, 2005, 2010, 2015, 2020)) +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by high income state")
box_plot_by_high_gdp
box_plot_by_low_gdp <- df %>%
filter(state_name %in% gdp_low) %>%
ggplot(aes(y = patent_count, x = as.factor(prio_year))) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
scale_x_continuous(limits = c(2000, 2005, 2010, 2015, 2020)) +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by low income state")
box_plot_by_low_gdp
box_plot_by_low_gdp <- df %>%
filter(state_name %in% gdp_low) %>%
ggplot(aes(y = patent_count, x = factor(prio_year))) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
scale_x_continuous(limits = c(2000, 2005, 2010, 2015, 2020)) +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by low income state")
box_plot_by_low_gdp
box_plot_by_low_gdp <- df %>%
filter(state_name %in% gdp_low) %>%
ggplot(aes(y = patent_count)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
scale_x_continuous(limits = c(2000, 2005, 2010, 2015, 2020)) +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by low income state")
box_plot_by_low_gdp
box_plot_by_low_gdp <- df %>%
filter(state_name %in% gdp_low) %>%
ggplot(aes(y = patent_count)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by low income state")
box_plot_by_low_gdp
box_plot_by_high_gdp <- df %>%
filter(state_name %in% gdp_high) %>%
ggplot(aes(y = patent_count)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name) +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by high income state")
box_plot_by_high_gdp
box_plot_by_low_gdp <- df %>%
filter(state_name %in% gdp_low) %>%
ggplot(aes(y = patent_count)) +
geom_boxplot(outlier.colour="red",
outlier.size=1) +
facet_wrap(~state_name, scales_y = "free") +
labs(x = "Priority filing year", y =  "Patent count") +
theme_bw() +
ggtitle("International US patent counts (Y02E class)", subtitle = "Distribution by low income state")
